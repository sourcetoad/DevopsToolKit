#!/usr/bin/env bash

#
# Script Output
#

# Determine width of the program
ACTUAL_WIDTH=$(($(tput cols) - 2))
MAX_WIDTH=100

if test "$ACTUAL_WIDTH" -gt "$MAX_WIDTH"; then
    WIDTH=$MAX_WIDTH
else
    WIDTH=$ACTUAL_WIDTH
fi

# Setup Color Outputs
if test -t 1; then
    ncolors=$(tput colors)

    if test -n "$ncolors" && test "$ncolors" -ge 8; then
        COLOR_R=1   # color code - RED
        COLOR_G=2   # color code - GREEN
        COLOR_Y=3   # color code - YELLOW
        COLOR_B=4   # color code - BLUE
        COLOR_M=5   # color code - MAGENTA
        COLOR_C=6   # color code - CYAN
        COLOR_N=246 # color code - NEUTRAL (GRAY)

        export BG_R="$(tput setab $COLOR_R)" # Background - RED
        export BG_G="$(tput setab $COLOR_G)" # Background - GREEN
        export BG_Y="$(tput setab $COLOR_Y)" # Background - YELLOW
        export BG_B="$(tput setab $COLOR_B)" # Background - BLUE
        export BG_M="$(tput setab $COLOR_M)" # Background - MAGENTA
        export BG_C="$(tput setab $COLOR_C)" # Background - CYAN
        export BG_N="$(tput setab $COLOR_N)" # Background - NEUTRAL (GRAY)

        export FG_R="$(tput setaf $COLOR_R)" # Foreground - RED
        export FG_G="$(tput setaf $COLOR_G)" # Foreground - GREEN
        export FG_Y="$(tput setaf $COLOR_Y)" # Foreground - YELLOW
        export FG_B="$(tput setaf $COLOR_B)" # Foreground - BLUE
        export FG_M="$(tput setaf $COLOR_M)" # Foreground - MAGENTA
        export FG_C="$(tput setaf $COLOR_C)" # Foreground - CYAN
        export FG_N="$(tput setaf $COLOR_N)" # Foreground - NEUTRAL (GRAY)

        export BOLD="$(tput bold)"
        export RESET="$(tput sgr0)"
    fi
fi

function join {
    local IFS="$1"
    shift
    echo "$*"
}

function tag {
    local STYLE=$1
    local LABEL=$2
    shift 2

    echo "$@" "${STYLE}  ${LABEL}  ${RESET} "
}

function output_tagged_string() {
    tag "$1" "$2" -n
    echo $3
}

function output_error {
    output_tagged_string "$BG_R" "ERROR" "$1"
}

function output_info {
    output_tagged_string "$BG_B" "INFO" "$1"
}
